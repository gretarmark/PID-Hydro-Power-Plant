function [D1out,D2out,D3out] = AnalogOpening90(u,Dmax1Gate)

    if u < 0
        D1 = 0; D2 = 0; D3 = 0;
    elseif (u>=0) && (u<1.111111) % Skipting 1
        D1 = u;
        D2 = 0;
        D3 = 0;
    elseif u>=1.111111 && u<2.222222
        D1 = 1.111110;
        D2 = u-1.111111;
        D3 = 0;
    elseif u>=2.222222 && u<3.333333
        D1 = 1.111110;
        D2 = 1.111110;
        D3 = u-2.222222;
    elseif u>=3.333333 && u<4.444444 % Skipting 2
        D1 = 1.111110 + (u-3.333333);
        D2 = 1.111110;
        D3 = 1.111110;
    elseif u>=4.444444 && u<5.555555
        D1 = 2.222220;
        D2 = 1.111110 + (u-4.444444);
        D3 = 1.111110;
    elseif u>=5.555555 && u<6.666666
        D3 = 1.111110 + (u-5.555555);
        D1 = 2.222220;
        D2 = 2.222220;
    elseif u>=6.666666 && u<7.777777 % Skipting 3
        D1 = 2.222220 + (u-6.666666); 
        D2 = 2.222220;
        D3 = 2.222220;
    elseif u>=7.777777 && u<8.888888
        D2 = 2.222220 + (u-7.777777);
        D1 = 3.333330;
        D3 = 2.222220;
    elseif u>=8.888888 && u<9.999999
        D3 = 2.222220 + (u-8.888888);
        D1 = 3.333330;
        D2 = 3.333330;
     elseif u>=9.999999 && u<11.111111
        D1 = 3.333330 + (u-9.999999);
        D2 = 3.333330;
        D3 = 3.333330;
    elseif u>=11.111111 && u<12.222222
        D2 = 3.333330 + (u-11.111111);
        D1 = 4.444440;
        D3 = 3.333330;
    elseif u>=12.222222 && u<13.333333
        D3 = 3.333330 + (u-12.222222);
        D1 = 4.444440;
        D2 = 4.444440;
    elseif u>=13.333333 && u<14.444444
        D1 = 4.444440 + (u-13.333333);
        D2 = 4.444440;
        D3 = 4.444440;
    elseif u>=14.444444 && u<15.555555
        D2 = 4.444440 + (u-14.444444);
        D1 = 5.555550;
        D3 = 4.444440;
    elseif u>=15.555555 && u<16.666666
        D3 = 4.444440 + (u-15.555555);
        D1 = 5.555550;
        D2 = 5.555550;
    elseif u>=16.666666 && u<17.777777
        D1 = 5.555550 + (u-16.666666);
        D2 = 5.555550;
        D3 = 5.555550;
    elseif u>=17.777777 && u<18.888888
        D2 = 5.555550 + (u-17.777777);
        D1 = 6.666660;
        D3 = 5.555550;
    elseif u>=18.888888 && u<19.999999
        D3 = 5.555550 + (u-18.888888);
        D1 = 6.666660;
        D2 = 6.666660;
    elseif u>=19.999999 && u<21.111111
        D1 = 6.666660 + (u-19.999999);
        D2 = 6.666660;
        D3 = 6.666660;
    elseif u>=21.111111 && u<22.222222
        D2 = 6.666660 + (u-21.111111);
        D1 = 7.777770;
        D3 = 6.666660;
    elseif u>=22.222222 && u<23.333333
        D3 = 6.666660 + (u-22.222222);
        D1 = 7.777770;
        D2 = 7.777770;
    elseif u>=23.333333 && u<24.444444
        D1 = 7.777770 + (u-23.333333);
        D2 = 7.777770;
        D3 = 7.777770;
    elseif u>=24.444444 && u<25.555555
        D2 = 7.777770 + (u-24.444444);
        D1 = 8.888880;
        D3 = 7.777770;
    elseif u>=25.555555 && u<26.666666
        D3 = 7.777770 + (u-25.555555);
        D1 = 8.888880;
        D2 = 8.888880;
    elseif u>=26.666666 && u<27.777777
        D1 = 8.888880 + (u-26.666666);
        D2 = 8.888880;
        D3 = 8.888880;
    elseif u>=27.777777 && u<28.888888
        D2 = 8.888880 + (u-27.777777);
        D1 = 9.999990;
        D3 = 8.888880;
    elseif u>=28.888888 && u<29.999999
        D3 = 8.888880 + (u-28.888888);
        D1 = 9.999990;
        D2 = 9.999990;
    elseif u>=29.999999 && u<31.111111
        D1 = 9.999990 + (u-29.999999);
        D2 = 9.999990;
        D3 = 9.999990;
    elseif u>=31.111111 && u<32.222222
        D2 = 9.999990 + (u-31.111111);
        D1 = 11.111110;
        D3 = 9.999990;
    elseif u>=32.222222 && u<33.333333
        D3 = 9.999990 + (u-32.222222);
        D1 = 11.111110;
        D2 = 11.111110;
    elseif u>=33.333333 && u<34.444444
        D1 = 11.111110 + (u-33.333333);
        D2 = 11.111110;
        D3 = 11.111110;
    elseif u>=34.444444 && u<35.555555
        D2 = 11.111110 + (u-34.444444);
        D1 = 12.222220;
        D3 = 11.111110;
    elseif u>=35.555555 && u<36.666666
        D3 = 11.111110 + (u-35.555555);
        D1 = 12.222220;
        D2 = 12.222220;
    elseif u>=36.666666 && u<37.777777
        D1 = 12.222220 + (u-36.666666);
        D2 = 12.222220;
        D3 = 12.222220;
    elseif u>=37.777777 && u<38.888888
        D2 = 12.222220 + (u-37.777777);
        D1 = 13.333330;
        D3 = 12.222220;
    elseif u>=38.888888 && u<39.999999
        D3 = 12.222220 + (u-38.888888);
        D1 = 13.333330;
        D2 = 13.333330;
    elseif u>=39.999999 && u<41.111111
        D1 = 13.333330 + (u-39.999999);
        D2 = 13.333330;
        D3 = 13.333330;
    elseif u>=41.111111 && u<42.222222
        D2 = 13.333330 + (u-41.111111);
        D1 = 14.444440;
        D3 = 13.333330;
    elseif u>=42.222222 && u<43.333333
        D3 = 13.333330 + (u-42.222222);
        D1 = 14.444440;
        D2 = 14.444440;
    elseif u>=43.333333 && u<44.444444
        D1 = 14.444440 + (u-43.333333);
        D2 = 14.444440;
        D3 = 14.444440;
    elseif u>=44.444444 && u<45.555555
        D2 = 14.444440 + (u-44.444444);
        D1 = 15.555550;
        D3 = 14.444440;
    elseif u>=45.555555 && u<46.666666
        D3 = 14.444440 + (u-45.555555);
        D1 = 15.555550;
        D2 = 15.555550;
    elseif u>=46.666666 && u<47.777777
        D1 = 15.555550 + (u-46.666666);
        D2 = 15.555550;
        D3 = 15.555550;
    elseif u>=47.777777 && u<48.888888
        D2 = 15.555550 + (u-47.777777);
        D1 = 16.666660;
        D3 = 15.555550;
    elseif u>=48.888888 && u<49.999999
        D3 = 15.555550 + (u-48.888888);
        D1 = 16.666660;
        D2 = 16.666660;
    elseif u>=49.999999 && u<51.111111
        D1 = 16.666660 + (u-49.999999);
        D2 = 16.666660;
        D3 = 16.666660;
    elseif u>=51.111111 && u<52.222222
        D2 = 16.666660 + (u-51.111111);
        D1 = 17.777770;
        D3 = 16.666660;
    elseif u>=52.222222 && u<53.333333
        D3 = 16.666660 + (u-52.222222);
        D1 = 17.777770;
        D2 = 17.777770;
    elseif u>=53.333333 && u<54.444444
        D1 = 17.777770 + (u-53.333333);
        D2 = 17.777770;
        D3 = 17.777770;
    elseif u>=54.444444 && u<55.555555
        D2 = 17.777770 + (u-54.444444);
        D1 = 18.888880;
        D3 = 17.777770;
    elseif u>=55.555555 && u<56.666666
        D3 = 17.777770 + (u-55.555555);
        D1 = 18.888880;
        D2 = 18.888880;
    elseif u>=56.666666 && u<57.777777
        D1 = 18.888880 + (u-56.666666);
        D2 = 18.888880;
        D3 = 18.888880;
    elseif u>=57.777777 && u<58.888888
        D2 = 18.888880 + (u-57.777777);
        D1 = 19.999990;
        D3 = 18.888880;
    elseif u>=58.888888 && u<59.999999
        D3 = 18.888880 + (u-58.888888);
        D1 = 19.999990;
        D2 = 19.999990;
    elseif u>=59.999999 && u<61.111111
        D1 = 19.999990 + (u-59.999999);
        D2 = 19.999990;
        D3 = 19.999990;
    elseif u>=61.111111 && u<62.222222
        D2 = 19.999990 + (u-61.111111);
        D1 = 21.111110;
        D3 = 19.999990;
    elseif u>=62.222222 && u<63.333333
        D3 = 19.999990 + (u-62.222222);
        D1 = 21.111110;
        D2 = 21.111110;
    elseif u>=63.333333 && u<64.444444
        D1 = 21.111110 + (u-63.333333);
        D2 = 21.111110;
        D3 = 21.111110;
    elseif u>=64.444444 && u<65.555555
        D2 = 21.111110 + (u-64.444444);
        D1 = 22.222220;
        D3 = 21.111110;
    elseif u>=65.555555 && u<66.666666
        D3 = 21.111110 + (u-65.555555);
        D1 = 22.222220;
        D2 = 22.222220;
    elseif u>=66.666666 && u<67.777777
        D1 = 22.222220 + (u-66.666666);
        D2 = 22.222220;
        D3 = 22.222220;
    elseif u>=67.777777 && u<68.888888
        D2 = 22.222220 + (u-67.777777);
        D1 = 23.333330;
        D3 = 22.222220;
    elseif u>=68.888888 && u<69.999999
        D3 = 22.222220 + (u-68.888888);
        D1 = 23.333330;
        D2 = 23.333330;
    elseif u>=69.999999 && u<71.111111
        D1 = 23.333330 + (u-69.999999);
        D2 = 23.333330;
        D3 = 23.333330;
    elseif u>=71.111111 && u<72.222222
        D2 = 23.333330 + (u-71.111111);
        D1 = 24.444440;
        D3 = 23.333330;
    elseif u>=72.222222 && u<73.333333
        D3 = 23.333330 + (u-72.222222);
        D1 = 24.444440;
        D2 = 24.444440;
    elseif u>=73.333333 && u<74.444444
        D1 = 24.444440 + (u-73.333333);
        D2 = 24.444440;
        D3 = 24.444440;
    elseif u>=74.444444 && u<75.555555
        D2 = 24.444440 + (u-74.444444);
        D1 = 25.555550;
        D3 = 24.444440;
    elseif u>=75.555555 && u<76.666666
        D3 = 24.444440 + (u-75.555555);
        D1 = 25.555550;
        D2 = 25.555550;
    elseif u>=76.666666 && u<77.777777
        D1 = 25.555550 + (u-76.666666);
        D2 = 25.555550;
        D3 = 25.555550;
    elseif u>=77.777777 && u<78.888888
        D2 = 25.555550 + (u-77.777777);
        D1 = 26.666660;
        D3 = 25.555550;
    elseif u>=78.888888 && u<79.999999
        D3 = 25.555550 + (u-78.888888);
        D1 = 26.666660;
        D2 = 26.666660;
    elseif u>=79.999999 && u<81.111111
        D1 = 26.666660 + (u-79.999999);
        D2 = 26.666660;
        D3 = 26.666660;
    elseif u>=81.111111 && u<82.222222
        D2 = 26.666660 + (u-81.111111);
        D1 = 27.777770;
        D3 = 26.666660;
    elseif u>=82.222222 && u<83.333333
        D3 = 26.666660 + (u-82.222222);
        D1 = 27.777770;
        D2 = 27.777770;
    elseif u>=83.333333 && u<84.444444
        D1 = 27.777770 + (u-83.333333);
        D2 = 27.777770;
        D3 = 27.777770;
    elseif u>=84.444444 && u<85.555555
        D2 = 27.777770 + (u-84.444444);
        D1 = 28.888880;
        D3 = 27.777770;
    elseif u>=85.555555 && u<86.666666
        D3 = 27.777770 + (u-85.555555);
        D1 = 28.888880;
        D2 = 28.888880;
    elseif u>=86.666666 && u<87.777777
        D1 = 28.888880 + (u-86.666666);
        D2 = 28.888880;
        D3 = 28.888880;
    elseif u>=87.777777 && u<88.888888
        D2 = 28.888880 + (u-87.777777);
        D1 = 29.999990;
        D3 = 28.888880;
    elseif u>=88.888888 && u<89.999999
        D3 = 28.888880 + (u-88.888888);
        D1 = 29.999990;
        D2 = 29.999990;
    elseif u>=89.999999 && u<91.111111
        D1 = 29.999990 + (u-89.999999);
        D2 = 29.999990;
        D3 = 29.999990;
    elseif u>=91.111111 && u<92.222222
        D2 = 29.999990 + (u-91.111111);
        D1 = 31.111110;
        D3 = 29.999990;
    elseif u>=92.222222 && u<93.333333
        D3 = 29.999990 + (u-92.222222);
        D1 = 31.111110;
        D2 = 31.111110;
    elseif u>=93.333333 && u<94.444444
        D1 = 31.111110 + (u-93.333333);
        D2 = 31.111110;
        D3 = 31.111110;
    elseif u>=94.444444 && u<95.555555
        D2 = 31.111110 + (u-94.444444);
        D1 = 32.222220;
        D3 = 31.111110;
    elseif u>=95.555555 && u<96.666666
        D3 = 31.111110 + (u-95.555555);
        D1 = 32.222220;
        D2 = 32.222220;
    elseif u>=96.666666 && u<97.777777
        D1 = 32.222220 + (u-96.666666);
        D2 = 32.222220;
        D3 = 32.222220;
    elseif u>=97.777777 && u<98.888888
        D2 = 32.222220 + (u-97.777777);
        D1 = 33.333330;
        D3 = 32.222220;
    elseif u>=98.888888 && u<99.999999
        D3 = 32.222220 + (u-98.888888);
        D1 = 33.333330;
        D2 = 33.333330;
    else
        D1 = 33.333330;
        D2 = 33.333330;
        D3 = 33.333330;
    end

    D1out = D1*(Dmax1Gate*0.01);
    D2out = D2*(Dmax1Gate*0.01);
    D3out = D3*(Dmax1Gate*0.01);

end